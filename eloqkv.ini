######################################
# EloqKV Server Configuration (INI)
######################################

######################################
# [local] Node-local settings
######################################
[local]

# Whether to listen on all network interfaces for the Redis front-end.
#bind_all=false

# Network identity for the tx_service Raft node (do not change after bootstrap).
#tx_ip=127.0.0.1
tx_port=15000
#port=15000

# Redis front-end listening port and logical DB count.
eloqkv_port=15000
#databases=16

# Base directory for DataSubstrate (tx_service metadata, Raft logs, etc.).
# If you change this after bootstrap you must wipe all persisted state first.
eloq_data_path=/home/eloq/eloqkv_data/db

# Optional overrides for tx/log directories; leave empty to derive from
# eloq_data_path.
#tx_service_data_path=
#log_service_data_path=

# Maximum simultaneous client connections (also used to raise RLIMIT_NOFILE).
maxclients=10000

# CPU and IO scheduling.
core_number=2
event_dispatcher_num=1

# Node memory limit for tx_service (MB). Recommended ~60% of system memory.
node_memory_limit_mb=10000

# Enable/disable major subsystems.
enable_data_store=true
enable_wal=false
#enable_cache_replacement=true
#enable_heap_defragment=false
enable_mvcc=true
#bootstrap=false

# IO tuning for Raft/WAL.
enable_io_uring=true
raft_log_async_fsync=true

# Log service snapshot/rocksdb overrides.
logserver_snapshot_interval=60
txlog_rocksdb_storage_path=/home/eloq/eloqkv_data/log
txlog_rocksdb_cloud_bucket_prefix=eloqkv-
txlog_rocksdb_cloud_bucket_name=zc
txlog_rocksdb_cloud_object_path=txlog
txlog_rocksdb_cloud_region=us-east-1
txlog_rocksdb_cloud_s3_endpoint_url=http://127.0.0.1:9900

# TxService maintenance intervals (seconds).
checkpointer_interval=30
#checkpoint_interval=30
#checkpointer_delay_seconds=5
#collect_active_tx_ts_interval_seconds=2
#range_slice_memory_limit_percent=10
#range_split_worker_num=0
#deadlock_check_interval_seconds=10
#max_standby_lag=400000

# TxService correctness/consistency knobs.
#kickout_data_for_test=false
#enable_key_cache=false
#realtime_sampling=true
#auto_redirect=true

# Host-manager integration (only used when fork_host_manager=true).
#fork_host_manager=true
#hm_ip=
#hm_port=0
#hm_bin_path=

# Client authentication (empty disables AUTH requirement).
#requirepass=

# Redis mode toggles.
#cluster_mode=false
#cc_notify=true
#cmd_read_catalog=false

# Slowlog & stats.
#slow_log_threshold=10000
#slow_log_max_length=128
#enable_redis_stats=false
#enable_cmd_sort=false

# Default command isolation level and CC protocol.
#isolation_level=RepeatableRead
#protocol=OCC

# MULTI/EXEC + Lua transaction behavior.
#txn_isolation_level=RepeatableRead
#txn_protocol=OCC
#retry_on_occ_error=false

# Optional worker pool for vector index commands (requires VECTOR_INDEX build).
#vector_index_worker_num=0

######################################
# [cluster] Cluster-wide configuration
######################################
[cluster]

# Comma-separated list of tx_service nodes (ip:port). For single-node
# deployment set this to the local tx_ip:tx_port.
#tx_ip_port_list=127.0.0.1:16379

# Optional lists for standby-only and voter-only members.
#tx_standby_ip_port_list=
#tx_voter_ip_port_list=

# Optional explicit path to the cluster config file written by host manager.
#cluster_config_file=

# Node-group replica count (>=3 recommended for HA).
#node_group_replica_num=3

# External txlog service endpoints (required when enable_wal=true and using
# standalone log servers).
#txlog_service_list=
#txlog_group_replica_num=1

######################################
# [store] Persistent storage settings
######################################
[store]

# Path for RocksDB data.
# Recommended to place on a dedicated disk for better performance.
#rocksdb_storage_path=rocksdb_data

# ---- EloqStore (KV storage engine) ----

# Comma-separated list of data directories for EloqStore. Leave empty for the
# default path under the base data directory.
#eloq_store_data_path_list=

# Maximum number of simultaneously open files.
eloq_store_open_files_limit=5000

# Cloud storage path (empty disables cloud tier).
eloq_store_cloud_store_path=eloqkv

# Cloud provider implementation (e.g. aws, gcs).
eloq_store_cloud_provider=aws

# Optional cloud endpoint override (leave empty for provider default).
# Examples:
#   MinIO   -> http://127.0.0.1:9000
#   AWS S3  -> https://s3.amazonaws.com
#   GCS/S3-compatible gateway -> https://storage.googleapis.com
eloq_store_cloud_endpoint=http://127.0.0.1:9900

# Target cloud region/zone identifier.
eloq_store_cloud_region=us-east-1

# Access credentials for the cloud provider (defaults suit local MinIO).
eloq_store_cloud_access_key=minioadmin
eloq_store_cloud_secret_key=minioadmin
aws_access_key_id=minioadmin
aws_secret_key=minioadmin

# Verify TLS certificates for the cloud endpoint.
#eloq_store_cloud_verify_ssl=false

# Data-page restart interval (bytes between restart points).
#eloq_store_data_page_restart_interval=16

# Index-page restart interval.
#eloq_store_index_page_restart_interval=16

# Initial number of pages to pre-allocate (per shard).
#eloq_store_init_page_count=32768

# Skip checksum verification when reading pages (only for testing).
#eloq_store_skip_verify_checksum=false

# Max cached index pages per shard. Accepts size suffixes (MB/GB/TB).
eloq_store_index_buffer_pool_size=1GB

# Manifest file size limit in bytes.
#eloq_store_manifest_limit=8388608

# io_uring submission queue depth per shard.
#eloq_store_io_queue_size=4096

# Max amount of in-flight write IO (bytes per shard).
#eloq_store_max_inflight_write=65536

# Maximum number of pages in a single write batch.
#eloq_store_max_write_batch_pages=256

# Size of the io_uring buffer ring.
#eloq_store_buf_ring_size=4096

# Coroutine stack size in bytes.
#eloq_store_coroutine_stack_size=32768

# Number of historical archives retained when append mode is enabled.
#eloq_store_num_retained_archives=0

# Minimum seconds between automatically generated archives.
#eloq_store_archive_interval_secs=86400

# Maximum concurrent archive tasks.
#eloq_store_max_archive_tasks=256

# File space amplification threshold for compaction.
#eloq_store_file_amplify_factor=2

# Limit on total local storage footprint (accepts size suffixes).
eloq_store_local_space_limit=500GB

# Reserve-space ratio (larger values reserve less space).
#eloq_store_reserve_space_ratio=100

# Download recent cloud files into the local cache on startup.
#eloq_store_prewarm_cloud_cache=false

# Number of concurrent prewarm tasks per shard.
#eloq_store_prewarm_task_count=3

# Reuse existing files found in the local cache directory.
#eloq_store_reuse_local_files=false

# B+Tree page size in bytes (must align with OS page size).
#eloq_store_data_page_size=4096

# log2 number of pages per data file.
#eloq_store_pages_per_file_shift=11

# Number of pointers per overflow page.
#eloq_store_overflow_pointers=16

# Write data in append-only mode.
eloq_store_data_append_mode=true

# Enable page compression for EloqStore data files.
#eloq_store_enable_compression=false

######################################
# Logging (GLOG)
######################################
# Logging is configured via environment variables:
#
#   export GLOG_log_dir=/path/to/log
#   export GLOG_max_log_size=1024
#
# See:
# https://github.com/google/glog/blob/master/docs/flags.md
